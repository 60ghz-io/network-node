#
# Makefile for the Terragraph Kernel module
#

M := $(CURDIR)
KSRC = $(KERNEL_SRC)

TG_MODNAME_SUFFIX?= dhd
TG_ENABLE_BH_COMMON ?= y
TG_ENABLE_GPS ?= y
TG_ENABLE_NSS ?= y
TG_ENABLE_PFE ?= n
TG_ENABLE_CFG80211 ?= y
TG_ENABLE_QWILMASTER ?= n
TG_ENABLE_PFIFOFC ?= n
TG_ENABLE_QUEUE_STATS ?= n

KBUILD_FLAGS ?= -C $(KSRC) M=$(M) TG_MODNAME_SUFFIX=$(TG_MODNAME_SUFFIX) \
	TG_ENABLE_BH_COMMON=$(TG_ENABLE_BH_COMMON) \
	TG_ENABLE_CFG80211=$(TG_ENABLE_CFG80211) \
	TG_ENABLE_DPAA2=$(TG_ENABLE_DPAA2) \
	TG_ENABLE_GPS=$(TG_ENABLE_GPS) \
	TG_ENABLE_NSS=$(TG_ENABLE_NSS) \
	TG_ENABLE_PFE=$(TG_ENABLE_PFE) \
	TG_ENABLE_PFIFOFC=$(TG_ENABLE_PFIFOFC) \
	TG_ENABLE_QUEUE_STATS=$(TG_ENABLE_QUEUE_STATS) \
	TG_ENABLE_QWILMASTER=$(TG_ENABLE_QWILMASTER) \
	MODULE_NAME=terragraph-$(TG_MODNAME_SUFFIX)

KBUILD_FLAGS += V=1

build:
	$(MAKE) $(KBUILD_FLAGS)

modules_install:
	$(MAKE) $(KBUILD_FLAGS) modules_install

clean:
	$(MAKE) $(KBUILD_FLAGS) clean
